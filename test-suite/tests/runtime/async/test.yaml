name: "Async JavaScript Runtime"
description: "Test async/await, Promises, and asynchronous operations"

tests:
  - name: "basic async await"
    script: "basic_async.ts"
    expected_stdout: "Starting async test\nDelayed greeting: Hello, Alice!\nBefore first await\nFirst result: Hello, Bob!\nBefore second await\nSecond result: Hello, Charlie!\nImmediate value: 42\nPromise.resolve: Already resolved\nAsync test completed\n"
    expected_stderr: ""
    expected_exit_code: 0
    timeout_ms: 10000

  - name: "promise chaining"
    script: "promise_chaining.ts"
    expected_stdout: "Starting promise chaining test\nTesting promise chaining\nFirst then: initial\nSecond then: second\nThird then: final\nTesting Promise.all\nPromise.all results: A,B,C\nTesting Promise.race\nPromise.race winner: fast\nTesting nested async\nProcessed data: validated-processed-input\nTesting concurrent operations\nConcurrent results: concurrent1 concurrent2 concurrent3\nElapsed time < 200ms: true\nPromise chaining test completed\n"
    expected_stderr: ""
    expected_exit_code: 0
    timeout_ms: 10000

  - name: "async error handling"
    script: "async_errors.ts"
    expected_stdout: "Starting async error handling test\nTesting basic async error handling\nCaught async error: Async error\nTesting Promise.reject\nCaught Promise.reject: Immediate rejection\nTesting async function that throws\nCaught function error: Function threw error\nTesting Promise.all with rejection\nCaught Promise.all error: Promise.all error\nTesting Promise.race with rejection\nCaught Promise.race error: Fast rejection\nTesting nested async errors\nInner catch: Function threw error\nOuter catch: Outer error\nTesting error in promise chain\nChain step 1: initial\nCaught chain error: Chain error\nTesting finally block\nCaught finally test error: Finally test error\nFinally block executed\nAsync error handling test completed\n"
    expected_stderr: ""
    expected_exit_code: 0
    timeout_ms: 10000

  - name: "timeout behavior"
    script: "timeout_behavior.ts"
    expected_stdout: "Starting timeout behavior test\nSetting timeout\nTimeout set, continuing\nTimeout executed\nTesting multiple timeouts\nTimeout 1 (100ms)\nTimeout 2 (200ms)\nTimeout 3 (300ms)\nAll timeouts completed\nTesting nested timeouts\nOuter timeout start\nOuter timeout end\nInner timeout executed\nTesting zero delay timeout\nBefore zero timeout\nAfter zero timeout set\nZero delay timeout executed\nTesting timeout vs immediate\nOrder test result: sync1,sync2,timeout\nTesting async function timing\nAsync function start\nAsync function timeout\nAsync function end\nGot result: async result\nTimeout behavior test completed\n"
    expected_stderr: ""
    expected_exit_code: 0
    timeout_ms: 15000 